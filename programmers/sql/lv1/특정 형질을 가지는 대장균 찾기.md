
# 대장균 분화 실험 - 비트 연산을 활용한 SQL 문제 정리

---

## 문제 개요

- 대장균은 일정 주기로 분화하며, 분화를 시작한 개체를 '부모 개체', 새로 분화된 개체를 '자식 개체'라고 부른다.
- `ECOLI_DATA` 테이블에 대장균 정보가 저장되어 있다.

| Column name | Type | Nullable | 설명 |
|:--|:--|:--|:--|
| ID | INTEGER | FALSE | 대장균 고유 ID |
| PARENT_ID | INTEGER | TRUE | 부모 개체 ID (최초 개체는 NULL) |
| SIZE_OF_COLONY | INTEGER | FALSE | 대장균 크기 |
| DIFFERENTIATION_DATE | DATE | FALSE | 분화된 날짜 |
| GENOTYPE | INTEGER | FALSE | 대장균이 가진 형질 정보 (비트 플래그) |

---

## 문제

**조건**
- 2번 형질을 보유하지 않음
- 1번 형질 또는 3번 형질을 보유함
- (1번, 3번 형질을 모두 보유한 경우도 포함)

**결과**
- 조건을 만족하는 대장균 개체 수(COUNT) 출력

---

## 예시 데이터

| ID | PARENT_ID | SIZE_OF_COLONY | DIFFERENTIATION_DATE | GENOTYPE |
|:--|:--|:--|:--|:--|
| 1 | NULL | 10 | 2019-01-01 | 8 |
| 2 | NULL | 2  | 2019-01-01 | 15 |
| 3 | 2    | 100| 2020-01-01 | 1 |
| 4 | 2    | 16 | 2020-01-01 | 13 |

---

## 2진수 변환

| ID | GENOTYPE(10진수) | GENOTYPE(2진수) | 보유 형질 (1=1번, 2=2번, 4=3번, 8=4번) |
|:--|:--|:--|:--|
| 1 | 8 | 1000 | 4번 |
| 2 | 15 | 1111 | 1,2,3,4번 |
| 3 | 1 | 0001 | 1번 |
| 4 | 13 | 1101 | 1,3,4번 |

---

## 조건 검토

- **2번 형질 없음**: (GENOTYPE & 2) = 0
- **1번 또는 3번 형질 있음**: (GENOTYPE & 1) != 0 OR (GENOTYPE & 4) != 0

---

## SQL 정답

```sql
SELECT COUNT(*) AS COUNT
FROM ECOLI_DATA
WHERE (GENOTYPE & 2) = 0
  AND (GENOTYPE & (1 | 4)) != 0;
```

**설명**
- (GENOTYPE & 2) = 0 → 2번 형질이 없는 경우
- (GENOTYPE & (1 | 4)) != 0 → 1번 또는 3번 형질이 있는 경우

---

## 결과

| COUNT |
|:-----:|
|   2   |

(조건을 만족하는 ID는 3, 4)

---

## 보너스: 비트 연산자 정리

| 연산자 | 기호 | 의미 | 용도 |
|:--|:--|:--|:--|
| 비트 AND | `&` | 둘 다 1이면 1 | 특정 속성 보유 여부 체크 |
| 비트 OR | `|` | 둘 중 하나라도 1이면 1 | 여러 속성 합치기 |
| 비트 XOR | `^` | 다르면 1 | 차이점 찾기 |
| 비트 NOT | `~` | 0과 1 반전 | 전체 부정 |

---

## 2진수 연산 과정 (예시)

**13 & 6**

- 변환:
  ```
  13 = 1101
   6 = 0110
  ```

- AND 연산:

| 자리수 | 8 | 4 | 2 | 1 |
|:------:|:--:|:--:|:--:|:--:|
| 13     | 1  | 1  | 0  | 1  |
| 6      | 0  | 1  | 1  | 0  |
| 결과   | 0  | 1  | 0  | 0  |

→ 결과: `0100₂ = 4`

---

# 요약
- GENOTYPE은 **2진수 플래그 구조**.
- SQL에서는 비트 연산자(`&`, `|`)로 형질 보유 여부를 빠르게 체크.
- **AND**: 특정 비트 보유 확인  
- **OR**: 여러 비트 중 하나라도 보유 확인
